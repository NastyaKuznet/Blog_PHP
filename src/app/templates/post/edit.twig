<!DOCTYPE html>
<html>
    <head>
        <title>Редактирование поста</title>
        <script>
        // Добавляем тег в список перед отправкой формы
        function addTag() {
            const tagInput = document.getElementById('new_tag');
            const selectedTagsDiv = document.getElementById('selected_tags');
            const tagName = tagInput.value.trim();

            if (tagName === '') return;

            // Создаем элемент списка
            const div = document.createElement('div');
            div.innerHTML = `
                <input type="hidden" name="tags[]" value="${tagName}">
                ${tagName} <button type="button" onclick="removeTag(this)" value="deleteTag">Удалить</button>
            `;
            selectedTagsDiv.appendChild(div);
            tagInput.value = '';
        }

        function removeTag(button) {
            button.parentElement.remove();
        }
    </script>
    </head>
    <body>
        <h1>Редактирование поста</h1>

        <form action="/post/edit/{{ post.id }}" method="POST">
            <p>Автор поста: {{ post.userNickname|escape }}</p>
            <div>
                <label for="title">Заголовок:</label><br>
                <input type="text" id="title" name="title" value="{{ post.title|escape }}" required>
            </div>
            <div>
                <label for="content">Содержание:</label><br>
                <textarea id="content" name="content" rows="5" cols="50" required>{{ post.content|escape }}</textarea>
            </div>

            <div>
                <label for="new_tag">Добавить тег:</label><br>
                <input type="text" id="new_tag" placeholder="Введите тег">
                <button type="button" onclick="addTag()">Добавить</button>
            </div>

            <div id="selected_tags" style="margin-top: 10px;">
                {% for tag in post.tags %}
                    <div>
                        <input type="hidden" name="tags[]" value="{{ tag.name }}">
                        {{ tag.name|escape }} <button type="button" onclick="removeTag(this)">Удалить</button>
                    </div>
                {% endfor %}
            </div>

            <div>
                <button type="submit" name="action" value="save">Сохранить изменения</button>
                <button type="submit" name="action" value="delete">Удалить пост</button>
                <a href="/">Лента</a>
            </div>
        </form>

    </body>
</html>